//
//  OpenTestCardsUseCase.swift
//  
//  Created by PayU S.A. on 14/12/2022.
//  Copyright Â© 2022 PayU S.A. All rights reserved.
//

import UIKit

final class OpenTestCardsUseCase {

  // MARK: - Private Properties
  private let service: PaymentCardServiceProtocol

  // MARK: - Initialization
  init(service: PaymentCardServiceProtocol) {
    self.service = service
  }

  // MARK: - Public Methods
  func execute(in presentingViewController: UIViewController?) {
    let viewController = TestPaymentCardsViewController.Factory().make()
    let navigationController = UINavigationController(rootViewController: viewController)
    presentingViewController?.present(navigationController, animated: true)
    viewController.delegate = self
  }
}

// MARK: - TestPaymentCardsViewControllerDelegate
extension OpenTestCardsUseCase: TestPaymentCardsViewControllerDelegate {
  func viewController(_ viewController: TestPaymentCardsViewController, didSelect paymentCard: PaymentCard) {
    viewController.navigationController?.dismiss(animated: true)
    if let service = service as? PaymentCardService {
      service.didChangePaymentCard(paymentCard)
    }
  }
}
